from PyQt5.QtWidgets import QWidget, QPushButton, QLabel
from PyQt5.QtCore import pyqtSignal
from PyQt5.QtGui import QPixmap
from pathlib import Path
import os

class MainWindow(QWidget):
    button_clicked = pyqtSignal()

    def __init__(self):
        super().__init__()
        # 파일의 위치를 기준으로 경로 설정
        self._base_path = Path(__file__).parent
        self._init_ui()

    def _init_ui(self):
        self.setWindowTitle("Main GUI")
        self.setFixedSize(400, 400)
        self._set_background()
        self._set_button()

    def _set_background(self):
        # self.bg_label 처럼 변수 앞에 self.을 붙여야 메모리에서 사라지지 않습니다.
        self.bg_label = QLabel(self)
        # Path 객체에 .as_posix()를 사용해서 경로 문자열을 먼저 만듭니다.
        map_path = (self._base_path / 'Images' / 'map.png').as_posix()
        pixmap = QPixmap(map_path)

        if pixmap.isNull():
            print(f"이미지 로드 실패: {map_path}")

        self.bg_label.setPixmap(pixmap)
        self.bg_label.setScaledContents(True)
        self.bg_label.setGeometry(0, 0, 400, 400)

    def _set_button(self):
        self.btn = QPushButton(self)
        self.btn.setGeometry(150, 200, 100, 50)

        # 이미지 경로를 문자열로 변환 (.as_posix() 사용)
        off_img_path = (self._base_path / 'Images' / '클릭_off.png').as_posix()

        self.btn.setStyleSheet(f"""
            QPushButton {{
                border-image: url({off_img_path});
            }}
            QPushButton:hover {{
                border-image: url({off_img_path});
            }}
        """)
        self.btn.clicked.connect(self.button_clicked.emit)
